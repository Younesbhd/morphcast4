(window.webpackJsonpCY=window.webpackJsonpCY||[]).push([[1],{51:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(4);function i(t,e){var n=t.allData,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.d,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!0},o=n.find((function(t){return t.type===e}));if(o){var a=s(o);if(null!=a&&u(o,a))return a}throw i}},52:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n.n(r),s=n(1),u=n.n(s),o=function(){function t(e,n){i()(this,t),this._minRestTime=e,this._lastDoneTime=0,this._canSchedule=!0,this._busyReject=n}return u()(t,[{key:"remainingMs",value:function(){return Math.max(0,this._minRestTime-(Date.now()-this._lastDoneTime))}},{key:"canSchedule",value:function(){return this._canSchedule&&0===this.remainingMs()}},{key:"scheduleNext",value:function(t){var e=this;return this.canSchedule()?(this._canSchedule=!1,Promise.resolve(t()).then((function(t){return e.processDone(),t})).catch((function(t){throw e.processDone(),t}))):Promise.reject(this._busyReject)}},{key:"processDone",value:function(){this._canSchedule=!0,this._lastDoneTime=Date.now()}}]),t}()},53:function(t,e,n){var r=n(57);function i(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(t,e,n){var i=r(t,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(arguments.length<3?t:n):s.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},55:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n.n(r),s=n(1),u=n.n(s),o=function(){function t(e){i()(this,t),this._lastTimestamp=null,this._reject=e}return u()(t,[{key:"push",value:function(t){if(null===this._lastTimestamp)this._lastTimestamp=t;else{if(this._lastTimestamp>t)return Promise.reject(this._reject);this._lastTimestamp=t}}}]),t}()},56:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(0),i=n.n(r),s=n(1),u=n.n(s),o=n(4),a=n(52),c=n(54),h=n(55),l=function(){function t(e,n,r,s,u){i()(this,t);var c=u.minRestTime,l=u.conf;this._minRestTimeHelper=new a.a(c,o.a),this._frameSequenceChecker=new h.a(o.c),this._labels=e,this._config_params=n,this._networkBasePath=s,this._load_options=l,this._load_options.cacheStrategy="networkOnly",this._load_options.transformUrlDelegate||(this._load_options.transformUrlDelegate=function(t){var e=t.split("/"),n=e[e.length-1];return r[n]})}return u()(t,[{key:"load",value:function(){var t=this;return this._canvas=document.createElement("canvas"),c.load(this._networkBasePath,this._load_options).then((function(e){t._runner=e}))}},{key:"process",value:function(t){var e=this;return this._minRestTimeHelper.scheduleNext((function(){return Promise.resolve().then((function(){return e._frameSequenceChecker.push(t.frameTimestamp)})).then((function(){return e._minRestTimeProcess(t)}))}))}},{key:"_minRestTimeProcess",value:function(){throw"You must implement _minRestTimeProcess"}},{key:"processImageData",value:function(t){return this._drawToCanvas(this._canvas,t),c.Image.getImageArray(this._canvas,{dstW:this._config_params.input_width,dstH:this._config_params.input_height,order:this._config_params.order,color:this._config_params.colorspace,bias:this._config_params.bias,scale:this._config_params.scale}).then((function(t){return t}))}},{key:"_drawToCanvas",value:function(t,e){t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e,0,0)}},{key:"runTheNetwork",value:function(t){var e=this;return this._runner.getInputViews()[0].set(t),this._runner.run().then((function(){return e.getNetworkOutput()}))}},{key:"getNetworkOutput",value:function(){var t=this._runner.getOutputViews(),e=[];return t.forEach((function(t){e.push(t.toActual())})),e}},{key:"getResultFromNetworkOutput",value:function(t){for(var e={},n=0;n<t.length;n++){var r=t[n],i={};if(this._labels[n].labels)for(var s=0;s<r.length;++s)i[this._labels[n].labels[s]]=r[s];else i=r;e[this._labels[n].key]=i}return e}},{key:"terminate",value:function(){}}]),t}()},57:function(t,e,n){var r=n(5);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},58:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return b})),n.d(e,"c",(function(){return T})),n.d(e,"d",(function(){return O}));var r=n(53),i=n.n(r),s=n(8),u=n.n(s),o=n(9),a=n.n(o),c=n(5),h=n.n(c),l=n(0),f=n.n(l),p=n(1),v=n.n(p);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a()(this,n)}}var m=function(){function t(e){if(f()(this,t),!e||e<0||e>1)throw new TypeError("Bad or more arguments needed");this._alphaAt10Fps=e,this._lastTimestampMs=null}return v()(t,[{key:"alphaAt10Fps",get:function(){return this._alphaAt10Fps}},{key:"lastTimestampMs",get:function(){return this._lastTimestampMs}},{key:"update",value:function(e){var n,r=e-this._lastTimestampMs;if(null===this._lastTimestampMs||r>=t.MAX_PERIOD_ALLOWED_MS)n=1;else{if(r<0||isNaN(e))throw new TypeError("Missing or bad timestamp during push (not an integer or antecedent to the one stored). Stored timestamp: "+this._lastTimestampMs+", pushed: "+e);n=t._computeAlpha(this._alphaAt10Fps,r)}return this._lastTimestampMs=e,n}}],[{key:"MAX_PERIOD_ALLOWED_MS",get:function(){return 1e3}},{key:"_computeAlpha",value:function(t,e){var n=e/1e3,r=Math.pow(1-t,10);return 1-Math.pow(r,n)}}]),t}(),d=v()((function t(e,n){var r=this;if(f()(this,t),(this instanceof t?this.constructor:void 0)===e||(this instanceof t?this.constructor:void 0)===t)throw new TypeError("Cannot construct abstract instances directly");n.forEach((function(t){if("function"!=typeof r[t])throw new TypeError("Must override method "+t)}))})),y=function(t){u()(n,t);var e=_(n);function n(){return f()(this,n),e.call(this,n,["push"])}return v()(n)}(d),g=function(t){u()(n,t);var e=_(n);function n(){var t;return f()(this,n),(t=e.call(this))._lastValue=null,t}return v()(n,[{key:"value",get:function(){return this._lastValue}},{key:"push",value:function(t){this._lastValue=t}}]),n}(y),w=function(t){u()(n,t);var e=_(n);function n(){var t;return f()(this,n),(t=e.call(this))._lastEma=null,t}return v()(n,[{key:"ema",get:function(){return this._lastEma}},{key:"push",value:function(t,e){if(null===this._lastEma)this._lastEma=t;else{if(isNaN(e))throw TypeError("Bad or missing alpha argument.");this._lastEma=(1-e)*this._lastEma+e*t}}}]),n}(y),k=function(t){u()(n,t);var e=_(n);function n(){var t;return f()(this,n),(t=e.call(this))._lastEmvar=null,t}return v()(n,[{key:"emvar",get:function(){return this._lastEmvar}},{key:"push",value:function(t,e){var r=t-this.ema;return i()(h()(n.prototype),"push",this).call(this,t,e),null===this._lastEmvar?(this._lastEmvar=0,this._lastEmvar):(this._lastEmvar=(1-e)*(this._lastEmvar+e*Math.pow(r,2)),this._lastEmvar)}}]),n}(w),E=function(t){u()(n,t);var e=_(n);function n(){return f()(this,n),e.call(this,n,["next"])}return v()(n)}(d),b={EMA:Symbol("ema"),EMVAR:Symbol("emvar"),NONE:Symbol("none")},T=function(t){u()(n,t);var e=_(n);function n(t){var r,i=t.type,s=void 0===i?b.EMVAR:i,u=t.alphaAt10Fps;switch(f()(this,n),r=e.call(this),s){case b.EMA:case b.EMVAR:r._processor=new k,r._alphaCalculator=new m(u);break;case b.NONE:r._processor=new g,r._alphaCalculator={update:function(){return null}};break;default:throw new TypeError("Not implemented")}return r._type=s,r}return v()(n,[{key:"next",value:function(t,e){var n=this._alphaCalculator.update(e);switch(this._processor.push(t,n),this._type){case b.EMVAR:return this._processor.emvar;case b.EMA:return this._processor.ema;case b.NONE:return this._processor.value}}},{key:"statistics",get:function(){return this._processor}}]),n}(E),O=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:b.NONE};f()(this,t),this._filters=new Array(e);for(var r=0;r<e;r++)this._filters[r]=new T(n)}return v()(t,[{key:"next",value:function(t,e){if(t.length!==this._filters.length)throw new TypeError("Wrong length of array in input.");return this._filters.map((function(n,r){return n.next(t[r],e)}))}}]),t}()},59:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(8),i=n.n(r),s=n(9),u=n.n(s),o=n(5),a=n.n(o),c=n(0),h=n.n(c),l=n(1),f=n.n(l);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=a()(t);if(e){var i=a()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=_(t),r=t.map((function(t){var e=t-n;return e*e})),i=r.reduce((function(t,e){return t+e}),0);return i/=r.length-e,Math.sqrt(i)}function _(t){return t.reduce((function(t,e){return t+e}),0)/t.length}var m=function(t){i()(n,t);var e=p(n);function n(){return h()(this,n),e.apply(this,arguments)}return f()(n,[{key:"avg",value:function(){if(0===this.length)throw new TypeError("Window is empty. Cannot compute average.");return _(this._queue)}},{key:"stddev",value:function(){if(0===this.length)throw new TypeError("Window is empty. Cannot compute standard deviation.");return v(this._queue)}},{key:"sample_stddev",value:function(){if(0===this.length)throw new TypeError("Window is empty. Cannot compute standard deviation.");if(1===this.length)throw new RangeError("Cannot estimate sample standard deviation for only one value.");return v(this._queue,1)}}]),n}(function(){function t(e){if(h()(this,t),!Number.isInteger(e)||e<1)throw new RangeError("Maximum window size must be an integer greater than zero.");this._maxLen=e,this._queue=[]}return f()(t,[{key:"enqueue",value:function(t){if(this._queue.unshift(t),this._queue.length>this._maxLen)return this._queue.pop()}},{key:"length",get:function(){return this._queue.length}}]),t}())},60:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n(0),i=n.n(r),s=n(1),u=n.n(s),o=n(53),a=n.n(o),c=n(8),h=n.n(c),l=n(9),f=n.n(l),p=n(5),v=n.n(p);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var m=function(t){h()(n,t);var e=_(n);function n(t){var r,s=t.windowLength,u=void 0===s?3:s;return i()(this,n),(r=e.call(this,u))._maxWindowLength=u,r}return u()(n,[{key:"push",value:function(t,e){var r;return r=this._isWindowFull()?n._clippingValue(t,this.avg(),e):t,a()(v()(n.prototype),"enqueue",this).call(this,r),r}},{key:"_isWindowFull",value:function(){return a()(v()(n.prototype),"length",this)>=this._maxWindowLength}}],[{key:"_clippingValue",value:function(t,e,n){var r=e-n,i=e+n;return Math.min(Math.max(t,r),i)}}]),n}(n(59).a),d=function(){function t(e){i()(this,t),this.boundAt10Fps=e,this.lastTimestampMs=null}return u()(t,[{key:"update",value:function(t){var e,n=t-this.lastTimestampMs;if(null===this.lastTimestampMs)e=this.boundAt10Fps;else{if(n<0||isNaN(t))throw new TypeError("Missing or bad timestamp during push (not an integer or antecedent to the one stored). Stored timestamp: "+this.lastTimestampMs+", pushed: "+t);e=this.boundAt10Fps*n/100}return this.lastTimestampMs=t,e}}]),t}(),y=function(){function t(e){var n=e.boundAt10Fps,r=e.windowLength;i()(this,t),this._clippingFilter=new m({windowLength:r}),this._boundCalculator=new d(n)}return u()(t,[{key:"next",value:function(t,e){var n=this._boundCalculator.update(e);return this._clippingFilter.push(t,n)}}]),t}()},66:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(7),i=n.n(r),s=n(0),u=n.n(s),o=n(1),a=n.n(o);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){return Object.values(t).reduce((function(t,e){return t+e}),0)}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];u()(this,t),this._avgEmotions={Angry:0,Disgust:0,Fear:0,Happy:0,Sad:0,Surprise:0},this._window={Angry:[],Disgust:[],Fear:[],Happy:[],Sad:[],Surprise:[]},this._enableRedistribution=r,this._emoThreshold=n/100,this._maxWindowSize=e,this._canTrain=!0}return a()(t,[{key:"getWindowUsage",value:function(){return this.getWindowSize()/this._maxWindowSize}},{key:"hasReachedMaxSize",value:function(){return this.getWindowSize()>=this._maxWindowSize}},{key:"getWindowSize",value:function(){return this._window.Angry.length}},{key:"canTrain",value:function(){return this._canTrain}},{key:"_pushToAvg",value:function(t){var e=this;Object.keys(this._avgEmotions).forEach((function(n){var r=e.getWindowSize(),i=t[n],s=e._avgEmotions[n];if(e.hasReachedMaxSize()){var u=e._window[n].shift();e._avgEmotions[n]=s+(i-u)/r}else e._avgEmotions[n]=(r*s+i)/(r+1);e._window[n].push(i)}))}},{key:"next",value:function(e){this.canTrain()&&this._pushToAvg(e);var n=this._rescaleValuesOverAvg(e),r=n.ret,i=n.redist;return this._enableRedistribution?r=t._applyRedistribution(r,i):r.Neutral=1-h(r),r}},{key:"_rescaleValuesOverAvg",value:function(t){var e=this,n=this._avgEmotions,r={},i={};return Object.keys(n).forEach((function(s){n[s]>e._emoThreshold?(r[s]=t[s]*(e._emoThreshold/(2*n[s])),i[s]=t[s]-r[s]):r[s]=t[s]})),{ret:r,redist:i}}}],[{key:"_applyRedistribution",value:function(t,e){var n={};Object.keys(e).forEach((function(r){Object.keys(t).forEach((function(i){i!==r&&(n[i]=n[i]||0,n[i]+=e[r]*t[i]/(h(t)-t[r]))}))}));var r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t);return Object.keys(n).forEach((function(t){r[t]+=n[t]})),r}}]),t}()}}]);